# TRADING RULES — IMMUTABLE WITHOUT HUMAN APPROVAL
# Last modified: 2026-02-15
# Modified by: AK (initial creation)

# =============================================================
# PAPER TRADING RULES
# =============================================================
paper_trading:
  enabled: true
  start_capital: 100000  # USD (simulated)

  minimum_duration_days: 90

  auto_halt:
    max_drawdown_pct: 25
    max_daily_loss_pct: 5
    sharpe_below_zero_days: 30
    correlation_spike: 0.90
    data_staleness_hours: 24

  max_position_pct: 50
  max_leverage: 1.0
  min_trade_interval_hours: 4
  max_daily_trades: 10

  report_frequency: daily
  alert_on_drawdown_pct: 10

# =============================================================
# LIVE TRADING RULES
# =============================================================
live_trading:
  human_gates:
    - initial_deployment
    - capital_increase
    - new_strategy_addition
    - position_limit_change
    - new_asset_addition
    - rule_modification
    - resume_after_halt

  prerequisites:
    paper_trading_days: 90
    paper_sharpe_minimum: 0.5
    paper_sharpe_pvalue: 0.05
    paper_max_drawdown_under: 25
    paper_min_trades: 50
    backtest_consistency: true

  deployment_schedule:
    month_1:
      capital_pct: 5
      max_loss_halt_pct: 15
    month_2:
      capital_pct: 10
      max_loss_halt_pct: 15
    month_3:
      capital_pct: 20
      max_loss_halt_pct: 15
    month_4_plus:
      capital_pct: 30
      max_loss_halt_pct: 15

  auto_halt:
    max_drawdown_pct: 20
    max_daily_loss_pct: 3
    max_position_value_usd: null
    slippage_exceeds_model_pct: 50
    api_error_consecutive: 3

  kill_switch:
    enabled: true
    method: "cancel_all_orders_and_sell_to_usdt"
    triggers:
      - "manual_human_command"
      - "drawdown_exceeds_max"
      - "daily_loss_exceeds_max"
      - "system_error_unrecoverable"

# =============================================================
# RESEARCH QUALITY STANDARDS
# =============================================================
research_standards:
  statistical:
    min_sharpe_ci_lower: 0.0
    min_pvalue: 0.05
    min_backtest_folds: 5
    min_trades_per_fold: 10
    multi_seed_max_std: 0.3
    multiple_testing_method: benjamini_hochberg
    fdr_threshold: 0.05

  costs:
    # Two-tier cost model:
    # Standard: 30 bps per side — Coinbase limit orders / DEX on L2 (Base/Arbitrum)
    # Stress test: 50 bps per side — Coinbase market orders at lowest tier
    # Guardrail enforces minimum 30 bps. Winners reported at both levels.
    standard_cost_bps: 30
    stress_test_cost_bps: 50
    exchange_fee_pct: 0.15
    slippage_pct: 0.10
    spread_estimate_pct: 0.05

  overfitting:
    max_features_per_model: 20
    max_hyperparameter_combos: 50
    require_out_of_sample: true
    embargo_days: 7
    require_leakage_test: true
    leakage_accuracy_threshold: 0.55

  model_lifecycle:
    max_model_age_days: 180
    staleness_check_frequency: daily
    rolling_sharpe_window_days: 60
    sharpe_decay_halt_days: 30
    backtest_divergence_std: 2.0

  position_sizing:
    method: inverse_volatility
    volatility_lookback_days: 30
    fractional_kelly: 0.5
    max_position_pct: 50
    rebalance_threshold_pct: 5
