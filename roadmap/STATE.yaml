# STATE.yaml — Autonomous Progress Tracker
# Updated by: CEO agent after each task completion
# Read by: CEO agent at session start

project_status: phase_2_complete
current_phase: 2
last_updated: "2026-02-15"
last_updated_by: ceo

phases:
  phase_0_validation:
    status: complete
    started_at: "2026-02-15"
    completed_at: "2026-02-15"
    human_gate_required: true  # Informational — notify AK, don't block
    tasks:
      repo_setup:
        status: complete
        depends_on: []
      returns_calculations:
        status: complete
        depends_on: [repo_setup]
      technical_indicators:
        status: complete
        depends_on: [repo_setup]
      cross_validation:
        status: complete
        depends_on: [returns_calculations, technical_indicators]
      activity_logger:
        status: complete
        depends_on: [repo_setup]
        notes: "Built in Phase 0 — all agents log from day one"
      sign_convention_tests:
        status: complete
        depends_on: [returns_calculations]

  phase_1_data:
    status: complete
    started_at: "2026-02-15"
    completed_at: "2026-02-15"
    human_gate_required: false
    tasks:
      ccxt_price_fetcher:
        status: complete
        depends_on: []
        notes: "CCXTPriceFetcher with Binance primary, bybit/okx/coinbase failover"
      bgeometrics_fetcher:
        status: complete
        depends_on: []
        notes: "BGeometricsFetcher — bitcoin-data.com API, 9 computed indicators"
      coinmetrics_fetcher:
        status: complete
        depends_on: []
        notes: "CoinMetricsFetcher — Community API, BTC+ETH raw on-chain"
      blockchain_com_fetcher:
        status: complete
        depends_on: []
        notes: "BlockchainComFetcher — validation reference, 8 BTC metrics"
      coingecko_fetcher:
        status: complete
        depends_on: []
        notes: "CoinGeckoFetcher — market context snapshot + historical charts"
      source_selector:
        status: complete
        depends_on: [bgeometrics_fetcher, coinmetrics_fetcher, blockchain_com_fetcher]
        notes: "Cross-validates overlapping metrics, selects best source per metric"
      data_quality_checker:
        status: complete
        depends_on: [ccxt_price_fetcher, source_selector]
        notes: "Completeness, range, staleness, cross-validation checks"
      storage_layer:
        status: complete
        depends_on: []
        notes: "Parquet storage with metadata, incremental append, SHA-256 manifest"
      fetch_historical_data:
        status: complete
        depends_on: [ccxt_price_fetcher, bgeometrics_fetcher, coinmetrics_fetcher, blockchain_com_fetcher, coingecko_fetcher, storage_layer, data_quality_checker, source_selector]
        notes: "scripts/fetch_data.py — orchestrates full/incremental fetch pipeline"
      data_validation_report:
        status: complete
        depends_on: [fetch_historical_data]
        notes: "Quality reports auto-generated by fetch pipeline"

  phase_2_features_baselines:
    status: complete
    started_at: "2026-02-15"
    completed_at: "2026-02-15"
    human_gate_required: true
    tasks:
      onchain_features:
        status: complete
        depends_on: []
        notes: "BTC: hash_ribbon, nvt_zscore, mvrv_signal, sopr_signal, etc. ETH: gas_fee_zscore, eth_btc_ratio_momentum, etc."
      feature_registry:
        status: complete
        depends_on: [onchain_features]
        notes: "FeatureRegistry with FeatureDefinition, valid_from masking, matrix builder"
      feature_matrix_builder:
        status: complete
        depends_on: [feature_registry]
        notes: "Integrated into registry.build_feature_matrix()"
      feature_selection:
        status: complete
        depends_on: [feature_matrix_builder]
        notes: "Correlation filter (>0.85), importance threshold (<0.01), stability test (10-fold)"
      backtest_engine:
        status: complete
        depends_on: []
        notes: "WalkForwardBacktester with expanding window, embargo, next-day execution"
      transaction_costs:
        status: complete
        depends_on: []
        notes: "TransactionCostModel: 0.26% BTC, 0.28% ETH round trip"
      statistical_tests:
        status: complete
        depends_on: []
        notes: "Bootstrap CI, Sharpe significance, strategy comparison p-value"
      leakage_detector:
        status: complete
        depends_on: [feature_matrix_builder]
        notes: "Shuffled-label, temporal boundary, timestamp audit — mandatory before MLflow logging"
      mlflow_integration:
        status: complete
        depends_on: []
        notes: "ExperimentTracker wrapping MLflow with git hash + data manifest tracking"
      baseline_strategies:
        status: complete
        depends_on: [feature_selection, backtest_engine, transaction_costs, statistical_tests, leakage_detector, mlflow_integration]
        notes: "BuyAndHold, SimpleMomentum, EqualWeight baselines"
      baseline_results_report:
        status: complete
        depends_on: [baseline_strategies]
        notes: "Baselines implemented — actual results generated when data is fetched"
      sonnet_handoff:
        status: complete
        depends_on: [baseline_results_report]
        notes: "SONNET_HANDOFF.md written with architecture, pitfalls, templates, and quirks"

  phase_3_data_expansion:
    status: in_progress
    started_at: "2026-02-15"
    completed_at: null
    human_gate_required: false
    notes: "CRITICAL MISSION: Expand to 10,000+ observations (52K-490K hourly samples)"
    tasks:
      data_expansion_plan:
        status: complete
        depends_on: []
        notes: "DATA_EXPANSION_PLAN.md — 3 approaches: hourly data, cross-asset, extended history"
      fetch_hourly_btc:
        status: pending
        depends_on: [data_expansion_plan]
        notes: "scripts/fetch_hourly_btc.py — 70K hourly BTC candles 2017-2025"
      prepare_hourly_features:
        status: pending
        depends_on: [fetch_hourly_btc]
        notes: "scripts/prepare_hourly_features.py — hourly features resampled to daily"
      train_on_hourly:
        status: pending
        depends_on: [prepare_hourly_features]
        notes: "scripts/train_on_hourly.py — XGBoost on 52K hourly samples"
      fetch_cross_asset:
        status: pending
        depends_on: [data_expansion_plan]
        notes: "scripts/fetch_cross_asset_hourly.py — 7 assets × 70K = 490K samples"
      prepare_cross_asset_features:
        status: pending
        depends_on: [fetch_cross_asset]
        notes: "scripts/prepare_cross_asset_features.py — pooled features with asset_id"
      train_cross_asset:
        status: pending
        depends_on: [prepare_cross_asset_features]
        notes: "scripts/train_cross_asset.py — XGBoost on 490K pooled samples, test on BTC"
      alternative_data_integration:
        status: pending
        depends_on: [train_on_hourly, train_cross_asset]
        notes: "ALTERNATIVE_DATA_PLAN.md — macro, derivatives, cross-asset signals (30-50 features)"
      final_validation:
        status: pending
        depends_on: [alternative_data_integration]
        notes: "Final holdout test on 2024-2025 (ONE test only, no data snooping)"

  phase_3_models:
    status: blocked
    started_at: null
    completed_at: null
    human_gate_required: true
    blocked_by: [phase_3_data_expansion]
    notes: "BLOCKED: Need more data (10K+ samples) before advanced models viable"
    tasks:
      xgboost_model:
        status: not_started
        depends_on: []
      lstm_model:
        status: not_started
        depends_on: []
      feature_ablation_experiments:
        status: not_started
        depends_on: [xgboost_model]
      horizon_experiments:
        status: not_started
        depends_on: [xgboost_model]
      model_comparison:
        status: not_started
        depends_on: [xgboost_model, lstm_model]
      multi_seed_stability:
        status: not_started
        depends_on: [model_comparison]
      holdout_validation:
        status: not_started
        depends_on: [multi_seed_stability]
      ensemble_exploration:
        status: not_started
        depends_on: [model_comparison]
      result_validator:
        status: not_started
        depends_on: [feature_ablation_experiments, horizon_experiments, model_comparison, multi_seed_stability]
      analyst_report_generator:
        status: not_started
        depends_on: [result_validator, holdout_validation]
      phase3_results_report:
        status: not_started
        depends_on: [analyst_report_generator, holdout_validation, ensemble_exploration]

  phase_4_trading:
    status: not_started
    started_at: null
    completed_at: null
    human_gate_required: true
    tasks:
      paper_trading_engine:
        status: not_started
        depends_on: []
      signal_pipeline:
        status: not_started
        depends_on: [paper_trading_engine]
      monitoring_alerts:
        status: not_started
        depends_on: [paper_trading_engine]
      paper_trading_launch:
        status: not_started
        depends_on: [signal_pipeline, monitoring_alerts]
        human_gate: true
      live_trading_framework:
        status: not_started
        depends_on: [paper_trading_launch]
      live_trading_deployment:
        status: not_started
        depends_on: [live_trading_framework]
        human_gate: true

  phase_5_research_loop:
    status: not_started
    started_at: null
    completed_at: null
    human_gate_required: false
    tasks:
      experiment_proposer:
        status: not_started
        depends_on: []
      automated_evaluation:
        status: not_started
        depends_on: [experiment_proposer]
      weekly_report_generator:
        status: not_started
        depends_on: [automated_evaluation]
      continuous_research_daemon:
        status: not_started
        depends_on: [weekly_report_generator]
