2026-02-16 00:15:07 [INFO] ================================================================================
2026-02-16 00:15:07 [INFO] PHASE 1: CROSS-ASSET POOLED TRAINING
2026-02-16 00:15:07 [INFO] ================================================================================
/home/akamath/sparky-ai/scripts/train_cross_asset_pooled.py:684: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  logger.info(f"Timestamp: {datetime.utcnow().isoformat()}")
2026-02-16 00:15:07 [INFO] Timestamp: 2026-02-16T05:15:07.115233
2026-02-16 00:15:07 [INFO] ================================================================================
2026-02-16 00:15:07 [INFO] LOADING AND POOLING CROSS-ASSET DATA
2026-02-16 00:15:07 [INFO] ================================================================================
2026-02-16 00:15:07 [INFO] Loading BTC hourly data from data/raw/btc/ohlcv_hourly.parquet
2026-02-16 00:15:07 [INFO]   BTC: 115,059 candles, 2013-01-01 00:00:00+00:00 to 2026-02-16 02:00:00+00:00
2026-02-16 00:15:07 [INFO] Computing 23 base features for BTC...
2026-02-16 00:15:13 [INFO]   BTC: 23 features computed
2026-02-16 00:15:13 [INFO]   BTC: 114,648 valid samples after feature computation
2026-02-16 00:15:13 [INFO] Loading ETH hourly data from data/raw/eth/ohlcv_hourly.parquet
2026-02-16 00:15:13 [INFO]   ETH: 79,963 candles, 2017-01-01 00:00:00+00:00 to 2026-02-16 03:00:00+00:00
2026-02-16 00:15:13 [INFO] Computing 23 base features for ETH...
2026-02-16 00:15:18 [INFO]   ETH: 23 features computed
2026-02-16 00:15:18 [INFO]   ETH: 79,764 valid samples after feature computation
2026-02-16 00:15:18 [INFO] Loading SOL hourly data from data/raw/sol/ohlcv_hourly.parquet
2026-02-16 00:15:18 [INFO]   SOL: 29,720 candles, 2021-02-25 10:00:00+00:00 to 2026-02-16 04:00:00+00:00
2026-02-16 00:15:18 [INFO] Computing 23 base features for SOL...
2026-02-16 00:15:20 [INFO]   SOL: 23 features computed
2026-02-16 00:15:20 [INFO]   SOL: 29,521 valid samples after feature computation
2026-02-16 00:15:20 [INFO] Loading DOT hourly data from data/raw/dot/ohlcv_hourly.parquet
2026-02-16 00:15:20 [INFO]   DOT: 30,720 candles, 2020-08-21 21:00:00+00:00 to 2026-02-16 04:00:00+00:00
2026-02-16 00:15:20 [INFO] Computing 23 base features for DOT...
2026-02-16 00:15:22 [INFO]   DOT: 23 features computed
2026-02-16 00:15:22 [INFO]   DOT: 30,512 valid samples after feature computation
2026-02-16 00:15:22 [INFO] Loading LINK hourly data from data/raw/link/ohlcv_hourly.parquet
2026-02-16 00:15:22 [INFO]   LINK: 57,836 candles, 2019-07-12 16:00:00+00:00 to 2026-02-16 03:00:00+00:00
2026-02-16 00:15:22 [INFO] Computing 23 base features for LINK...
2026-02-16 00:15:25 [INFO]   LINK: 23 features computed
2026-02-16 00:15:25 [INFO]   LINK: 57,637 valid samples after feature computation
2026-02-16 00:15:25 [INFO] Loading ADA hourly data from data/raw/ada/ohlcv_hourly.parquet
2026-02-16 00:15:25 [INFO]   ADA: 51,532 candles, 2020-04-01 00:00:00+00:00 to 2026-02-16 03:00:00+00:00
2026-02-16 00:15:25 [INFO] Computing 23 base features for ADA...
2026-02-16 00:15:28 [INFO]   ADA: 23 features computed
2026-02-16 00:15:28 [INFO]   ADA: 51,322 valid samples after feature computation
2026-02-16 00:15:28 [INFO] 
Pooling all assets...
2026-02-16 00:15:28 [INFO] Total pooled samples: 363,404
2026-02-16 00:15:28 [INFO] Total features: 24 (23 base + 1 asset_id)
2026-02-16 00:15:28 [INFO] Date range: 2013-01-09 08:00:00+00:00 to 2026-02-16 04:00:00+00:00
2026-02-16 00:15:28 [INFO] Target balance: 50.31% positive
2026-02-16 00:15:28 [INFO] 
Asset distribution:
2026-02-16 00:15:28 [INFO]   BTC: 114,648 samples (31.5%)
2026-02-16 00:15:28 [INFO]   ETH: 79,764 samples (21.9%)
2026-02-16 00:15:28 [INFO]   SOL: 29,521 samples (8.1%)
2026-02-16 00:15:28 [INFO]   DOT: 30,512 samples (8.4%)
2026-02-16 00:15:28 [INFO]   LINK: 57,637 samples (15.9%)
2026-02-16 00:15:28 [INFO]   ADA: 51,322 samples (14.1%)
2026-02-16 00:15:28 [INFO] ================================================================================
2026-02-16 00:15:28 [INFO] CREATING TRAIN/VAL/TEST/HOLDOUT SPLITS
2026-02-16 00:15:28 [INFO] ================================================================================
2026-02-16 00:15:28 [INFO] Train (all assets): 2017-01-01 to 2020-12-31 (91,915 samples)
2026-02-16 00:15:28 [INFO] Validation (all assets): 2021-01-01 to 2022-12-31 (103,521 samples)
2026-02-16 00:15:28 [INFO] Test (all assets): 2023-01-01 to 2023-12-31 (52,538 samples)
2026-02-16 00:15:28 [INFO] Holdout (BTC only): 2024-01-01 to 2025-12-31 (17,541 samples)
2026-02-16 00:15:28 [INFO] 
Train asset distribution:
2026-02-16 00:15:28 [INFO] asset_id
btc     35060
eth     34840
link    12715
ada      6400
dot      2900
2026-02-16 00:15:28 [INFO] 
Validation asset distribution:
2026-02-16 00:15:28 [INFO] asset_id
eth     17520
link    17520
btc     17518
ada     17510
dot     17492
sol     15961
2026-02-16 00:15:28 [INFO] 
Test asset distribution:
2026-02-16 00:15:28 [INFO] asset_id
ada     8760
btc     8759
eth     8757
link    8755
sol     8755
dot     8752
2026-02-16 00:15:28 [INFO] ================================================================================
2026-02-16 00:15:28 [INFO] MULTI-SEED STABILITY VALIDATION
2026-02-16 00:15:28 [INFO] ================================================================================
2026-02-16 00:15:28 [INFO] 
Training with seed=0...
2026-02-16 00:15:28 [INFO] Training CatBoost model (seed=0)...
2026-02-16 00:15:31 [INFO] Model training complete
2026-02-16 00:15:31 [INFO] Evaluating on val_seed0...
2026-02-16 00:15:31 [INFO]   val_seed0 - Accuracy: 0.5309, ROC-AUC: 0.5429, Precision: 0.5292, Recall: 0.5507, F1: 0.5397
2026-02-16 00:15:31 [INFO] Evaluating on test_seed0...
2026-02-16 00:15:31 [INFO]   test_seed0 - Accuracy: 0.5384, ROC-AUC: 0.5532, Precision: 0.5464, Recall: 0.5306, F1: 0.5384
2026-02-16 00:15:31 [INFO] Evaluating on holdout_seed0...
2026-02-16 00:15:31 [INFO]   holdout_seed0 - Accuracy: 0.5273, ROC-AUC: 0.5391, Precision: 0.5307, Recall: 0.5983, F1: 0.5625
2026-02-16 00:15:31 [INFO] 
Training with seed=42...
2026-02-16 00:15:31 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:15:33 [INFO] Model training complete
2026-02-16 00:15:33 [INFO] Evaluating on val_seed42...
2026-02-16 00:15:34 [INFO]   val_seed42 - Accuracy: 0.5299, ROC-AUC: 0.5417, Precision: 0.5280, Recall: 0.5544, F1: 0.5409
2026-02-16 00:15:34 [INFO] Evaluating on test_seed42...
2026-02-16 00:15:34 [INFO]   test_seed42 - Accuracy: 0.5380, ROC-AUC: 0.5529, Precision: 0.5461, Recall: 0.5282, F1: 0.5370
2026-02-16 00:15:34 [INFO] Evaluating on holdout_seed42...
2026-02-16 00:15:34 [INFO]   holdout_seed42 - Accuracy: 0.5317, ROC-AUC: 0.5397, Precision: 0.5347, Recall: 0.5990, F1: 0.5650
2026-02-16 00:15:34 [INFO] 
Training with seed=123...
2026-02-16 00:15:34 [INFO] Training CatBoost model (seed=123)...
2026-02-16 00:15:36 [INFO] Model training complete
2026-02-16 00:15:36 [INFO] Evaluating on val_seed123...
2026-02-16 00:15:36 [INFO]   val_seed123 - Accuracy: 0.5309, ROC-AUC: 0.5418, Precision: 0.5282, Recall: 0.5709, F1: 0.5487
2026-02-16 00:15:36 [INFO] Evaluating on test_seed123...
2026-02-16 00:15:36 [INFO]   test_seed123 - Accuracy: 0.5398, ROC-AUC: 0.5524, Precision: 0.5454, Recall: 0.5574, F1: 0.5514
2026-02-16 00:15:36 [INFO] Evaluating on holdout_seed123...
2026-02-16 00:15:36 [INFO]   holdout_seed123 - Accuracy: 0.5281, ROC-AUC: 0.5405, Precision: 0.5315, Recall: 0.5959, F1: 0.5619
2026-02-16 00:15:36 [INFO] 
Training with seed=456...
2026-02-16 00:15:36 [INFO] Training CatBoost model (seed=456)...
2026-02-16 00:15:38 [INFO] Model training complete
2026-02-16 00:15:38 [INFO] Evaluating on val_seed456...
2026-02-16 00:15:39 [INFO]   val_seed456 - Accuracy: 0.5295, ROC-AUC: 0.5416, Precision: 0.5277, Recall: 0.5523, F1: 0.5397
2026-02-16 00:15:39 [INFO] Evaluating on test_seed456...
2026-02-16 00:15:39 [INFO]   test_seed456 - Accuracy: 0.5393, ROC-AUC: 0.5543, Precision: 0.5453, Recall: 0.5528, F1: 0.5490
2026-02-16 00:15:39 [INFO] Evaluating on holdout_seed456...
2026-02-16 00:15:39 [INFO]   holdout_seed456 - Accuracy: 0.5288, ROC-AUC: 0.5387, Precision: 0.5309, Recall: 0.6191, F1: 0.5716
2026-02-16 00:15:39 [INFO] 
Training with seed=789...
2026-02-16 00:15:39 [INFO] Training CatBoost model (seed=789)...
2026-02-16 00:15:41 [INFO] Model training complete
2026-02-16 00:15:41 [INFO] Evaluating on val_seed789...
2026-02-16 00:15:41 [INFO]   val_seed789 - Accuracy: 0.5284, ROC-AUC: 0.5379, Precision: 0.5239, Recall: 0.6114, F1: 0.5643
2026-02-16 00:15:41 [INFO] Evaluating on test_seed789...
2026-02-16 00:15:41 [INFO]   test_seed789 - Accuracy: 0.5359, ROC-AUC: 0.5481, Precision: 0.5385, Recall: 0.5958, F1: 0.5657
2026-02-16 00:15:41 [INFO] Evaluating on holdout_seed789...
2026-02-16 00:15:41 [INFO]   holdout_seed789 - Accuracy: 0.5306, ROC-AUC: 0.5401, Precision: 0.5322, Recall: 0.6252, F1: 0.5750
2026-02-16 00:15:41 [INFO] 
================================================================================
2026-02-16 00:15:41 [INFO] MULTI-SEED RESULTS
2026-02-16 00:15:41 [INFO] ================================================================================
2026-02-16 00:15:41 [INFO] Validation AUC: 0.5412 ± 0.0017
2026-02-16 00:15:41 [INFO] Test AUC: 0.5522 ± 0.0021
2026-02-16 00:15:41 [INFO] Holdout AUC: 0.5396 ± 0.0007
2026-02-16 00:15:41 [INFO] Stability check: std(holdout_auc) = 0.0007 PASS (threshold < 0.01)
2026-02-16 00:15:41 [INFO] ================================================================================
2026-02-16 00:15:41 [INFO] WALK-FORWARD VALIDATION
2026-02-16 00:15:41 [INFO] ================================================================================
2026-02-16 00:15:41 [INFO] Walk-forward data: 247,974 samples from 2017-01-01 to 2023-12-31
2026-02-16 00:15:41 [INFO] 
Fold 1: Train 2017-01-01 to 2018-06-06 (24,801 samples), Test 2018-06-06 to 2019-09-30 (24,797 samples)
2026-02-16 00:15:41 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:15:42 [INFO] Model training complete
2026-02-16 00:15:42 [INFO] Evaluating on fold1...
2026-02-16 00:15:42 [INFO]   fold1 - Accuracy: 0.5286, ROC-AUC: 0.5487, Precision: 0.5188, Recall: 0.6995, F1: 0.5958
2026-02-16 00:15:42 [INFO] 
Fold 2: Train 2017-01-01 to 2019-09-30 (49,598 samples), Test 2019-09-30 to 2020-08-01 (24,797 samples)
2026-02-16 00:15:42 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:15:43 [INFO] Model training complete
2026-02-16 00:15:43 [INFO] Evaluating on fold2...
2026-02-16 00:15:43 [INFO]   fold2 - Accuracy: 0.5361, ROC-AUC: 0.5472, Precision: 0.5386, Recall: 0.5189, F1: 0.5286
2026-02-16 00:15:43 [INFO] 
Fold 3: Train 2017-01-01 to 2020-08-01 (74,395 samples), Test 2020-08-01 to 2021-03-02 (24,797 samples)
2026-02-16 00:15:43 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:15:46 [INFO] Model training complete
2026-02-16 00:15:46 [INFO] Evaluating on fold3...
2026-02-16 00:15:46 [INFO]   fold3 - Accuracy: 0.5389, ROC-AUC: 0.5561, Precision: 0.5527, Recall: 0.5361, F1: 0.5443
2026-02-16 00:15:46 [INFO] 
Fold 4: Train 2017-01-01 to 2021-03-02 (99,192 samples), Test 2021-03-02 to 2021-08-22 (24,797 samples)
2026-02-16 00:15:46 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:15:48 [INFO] Model training complete
2026-02-16 00:15:48 [INFO] Evaluating on fold4...
2026-02-16 00:15:48 [INFO]   fold4 - Accuracy: 0.5311, ROC-AUC: 0.5416, Precision: 0.5328, Recall: 0.6104, F1: 0.5690
2026-02-16 00:15:48 [INFO] 
Fold 5: Train 2017-01-01 to 2021-08-22 (123,989 samples), Test 2021-08-22 to 2022-02-10 (24,797 samples)
2026-02-16 00:15:48 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:15:52 [INFO] Model training complete
2026-02-16 00:15:52 [INFO] Evaluating on fold5...
2026-02-16 00:15:52 [INFO]   fold5 - Accuracy: 0.5342, ROC-AUC: 0.5511, Precision: 0.5288, Recall: 0.5899, F1: 0.5577
2026-02-16 00:15:52 [INFO] 
Fold 6: Train 2017-01-01 to 2022-02-10 (148,786 samples), Test 2022-02-10 to 2022-08-02 (24,797 samples)
2026-02-16 00:15:52 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:15:55 [INFO] Model training complete
2026-02-16 00:15:55 [INFO] Evaluating on fold6...
2026-02-16 00:15:55 [INFO]   fold6 - Accuracy: 0.5318, ROC-AUC: 0.5398, Precision: 0.5205, Recall: 0.5770, F1: 0.5473
2026-02-16 00:15:55 [INFO] 
Fold 7: Train 2017-01-01 to 2022-08-02 (173,583 samples), Test 2022-08-02 to 2023-01-21 (24,797 samples)
2026-02-16 00:15:55 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:16:00 [INFO] Model training complete
2026-02-16 00:16:00 [INFO] Evaluating on fold7...
2026-02-16 00:16:00 [INFO]   fold7 - Accuracy: 0.5335, ROC-AUC: 0.5455, Precision: 0.5358, Recall: 0.5201, F1: 0.5278
2026-02-16 00:16:00 [INFO] 
Fold 8: Train 2017-01-01 to 2023-01-21 (198,380 samples), Test 2023-01-21 to 2023-07-12 (24,797 samples)
2026-02-16 00:16:00 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:16:05 [INFO] Model training complete
2026-02-16 00:16:05 [INFO] Evaluating on fold8...
2026-02-16 00:16:05 [INFO]   fold8 - Accuracy: 0.5418, ROC-AUC: 0.5552, Precision: 0.5473, Recall: 0.5263, F1: 0.5366
2026-02-16 00:16:05 [INFO] 
Fold 9: Train 2017-01-01 to 2023-07-12 (223,177 samples), Test 2023-07-12 to 2023-12-31 (24,797 samples)
2026-02-16 00:16:05 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:16:10 [INFO] Model training complete
2026-02-16 00:16:10 [INFO] Evaluating on fold9...
2026-02-16 00:16:10 [INFO]   fold9 - Accuracy: 0.5419, ROC-AUC: 0.5597, Precision: 0.5491, Recall: 0.5254, F1: 0.5370
2026-02-16 00:16:10 [INFO] 
================================================================================
2026-02-16 00:16:10 [INFO] WALK-FORWARD RESULTS
2026-02-16 00:16:10 [INFO] ================================================================================
2026-02-16 00:16:10 [INFO] Mean AUC: 0.5494 ± 0.0064
2026-02-16 00:16:10 [INFO] Min AUC: 0.5398
2026-02-16 00:16:10 [INFO] Max AUC: 0.5597
2026-02-16 00:16:10 [INFO] 
================================================================================
2026-02-16 00:16:10 [INFO] TRAINING FINAL MODEL (train + val + test)
2026-02-16 00:16:10 [INFO] ================================================================================
2026-02-16 00:16:10 [INFO] Training CatBoost model (seed=42)...
2026-02-16 00:16:16 [INFO] Model training complete
2026-02-16 00:16:16 [INFO] Evaluating on final_holdout...
2026-02-16 00:16:16 [INFO]   final_holdout - Accuracy: 0.5280, ROC-AUC: 0.5415, Precision: 0.5328, Recall: 0.5720, F1: 0.5517
2026-02-16 00:16:16 [INFO] ================================================================================
2026-02-16 00:16:16 [INFO] LEAKAGE CHECK: Shuffled-Label Test
2026-02-16 00:16:16 [INFO] ================================================================================
2026-02-16 00:16:16 [INFO] Shuffled-label AUC: 0.5003
2026-02-16 00:16:16 [INFO] PASS: Shuffled-label AUC 0.5003 ≤ 0.55 (no leakage)
2026-02-16 00:16:16 [INFO] 
Top 10 Feature Importances:
2026-02-16 00:16:16 [INFO]   1. rsi_6h: 29.2568
2026-02-16 00:16:16 [INFO]   2. hour_of_day: 8.7484
2026-02-16 00:16:16 [INFO]   3. ema_ratio_20h: 5.4777
2026-02-16 00:16:16 [INFO]   4. macd_histogram: 4.9714
2026-02-16 00:16:16 [INFO]   5. momentum_4h: 4.6331
2026-02-16 00:16:16 [INFO]   6. day_of_week: 3.6718
2026-02-16 00:16:16 [INFO]   7. rsi_14h: 3.5615
2026-02-16 00:16:16 [INFO]   8. higher_highs_lower_lows_5h: 3.5373
2026-02-16 00:16:16 [INFO]   9. momentum_168h: 3.3841
2026-02-16 00:16:16 [INFO]   10. bb_position_20h: 3.2891
/home/akamath/sparky-ai/scripts/train_cross_asset_pooled.py:725: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "timestamp": datetime.utcnow().isoformat(),
2026-02-16 00:16:16 [INFO] 
================================================================================
2026-02-16 00:16:16 [INFO] PHASE 1: CROSS-ASSET POOLED TRAINING — FINAL SUMMARY
2026-02-16 00:16:16 [INFO] ================================================================================
2026-02-16 00:16:16 [INFO] 
BASELINE (BTC-only CatBoost):
2026-02-16 00:16:16 [INFO]   Holdout AUC: 0.5360
2026-02-16 00:16:16 [INFO] 
CROSS-ASSET POOLED (6 assets):
2026-02-16 00:16:16 [INFO]   Training samples: 91,915
2026-02-16 00:16:16 [INFO]   Validation AUC: 0.5412 ± 0.0017
2026-02-16 00:16:16 [INFO]   Test AUC: 0.5522 ± 0.0021
2026-02-16 00:16:16 [INFO]   Holdout AUC: 0.5396 ± 0.0007
2026-02-16 00:16:16 [INFO]   Delta from baseline: +0.0036 (+0.67%)
2026-02-16 00:16:16 [INFO] 
VALIDATION CHECKS:
2026-02-16 00:16:16 [INFO]   Multi-seed stability: 0.0007 PASS (std < 0.01)
2026-02-16 00:16:16 [INFO]   Walk-forward mean AUC: 0.5494
2026-02-16 00:16:16 [INFO]   Leakage check: PASS
2026-02-16 00:16:16 [INFO] 
FEATURE IMPORTANCE:
2026-02-16 00:16:16 [INFO]   1. rsi_6h: 29.2568
2026-02-16 00:16:16 [INFO]   2. hour_of_day: 8.7484
2026-02-16 00:16:16 [INFO]   3. ema_ratio_20h: 5.4777
2026-02-16 00:16:16 [INFO]   4. macd_histogram: 4.9714
2026-02-16 00:16:16 [INFO]   5. momentum_4h: 4.6331
2026-02-16 00:16:16 [INFO] 
================================================================================
2026-02-16 00:16:16 [INFO] RECOMMENDATION
2026-02-16 00:16:16 [INFO] ================================================================================
2026-02-16 00:16:16 [ERROR] ❌ STOP — Reassess approach
2026-02-16 00:16:16 [ERROR] Rationale: Holdout AUC 0.5396 < 0.55 threshold
2026-02-16 00:16:16 [INFO] ================================================================================

2026-02-16 00:16:16 [INFO] 
Results saved to results/cross_asset_pooled/phase1_results.json
2026-02-16 00:16:16 [INFO] Phase 1 execution complete!
